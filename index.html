<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Kasir Modern - POS Digital</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        // Periksa dukungan jsPDF
        window.jsPDF = window.jspdf.jsPDF;
    </script>
</head>
<body>
    <div class="safe-area">
        <div class="container">
            <header class="app-header">
                <div class="header-top">
                    <h1>Kasir Modern</h1>
                    <div class="header-actions">
                        <input type="search" id="searchItem" placeholder="Cari barang... (tekan Enter untuk kelola)" class="form-control touch-target" autocomplete="off">
                        <button id="openManageBtn" class="btn btn--outline touch-target">Kelola Barang</button>
                        <button id="openEarningsBtn" class="btn btn--outline touch-target">Pendapatan</button>
                    </div>
                </div>
                <p class="app-subtitle">Sistem POS Digital Terpadu</p>
            </header>

            <main class="main-content">
                <!-- Input & Payment Section -->
                <section class="card input-payment-section">
                    <div class="card__header">
                        <h2>Tambah Barang & Pembayaran</h2>
                    </div>
                    <div class="card__body">
                        <!-- Input Section -->
                        <div class="form-group">
                            <label for="itemName" class="form-label">Nama Barang</label>
                            <input 
                                type="text" 
                                id="itemName" 
                                class="form-control touch-target" 
                                placeholder="Masukkan nama barang..."
                                autocomplete="off"
                            >
                            <div class="error-message" id="itemNameError" style="display:none;"></div>
                        </div>
                        <div class="form-group">
                            <label for="itemPrice" class="form-label">Harga Barang (Jual)</label>
                            <div class="currency-input-wrapper">
                                <span class="currency-prefix">Rp</span>
                                <input 
                                    type="text" 
                                    id="itemPrice" 
                                    class="form-control touch-target currency-input" 
                                    placeholder="0" 
                                    inputmode="numeric"
                                    autocomplete="off"
                                >
                            </div>
                            <div class="error-message" id="itemPriceError" style="display:none;"></div>
                        </div>
                        <button id="addItemBtn" class="btn btn--primary btn--full-width touch-target" disabled>
                            <span class="btn-icon">+</span>
                            Tambah Barang
                        </button>

                        <!-- Payment Section -->
                        <div class="payment-section-in-card">
                            <h3 class="section-title">Pembayaran</h3>
                            <div class="form-group">
                                <label for="moneyReceived" class="form-label">Uang Diterima</label>
                                <div class="currency-input-wrapper">
                                    <span class="currency-prefix">Rp</span>
                                    <input 
                                        type="text" 
                                        id="moneyReceived" 
                                        class="form-control touch-target currency-input" 
                                        placeholder="0" 
                                        inputmode="numeric"
                                        autocomplete="off"
                                    >
                                </div>
                            </div>
                            
                            <div class="change-display">
                                <div class="change-row">
                                    <span class="change-label">Uang Kembalian</span>
                                    <span id="changeAmount" class="change-amount">Rp 0</span>
                                </div>
                            </div>
                            
                            <div class="payment-actions">
                                <button id="printReceiptBtn" class="btn btn--primary btn--full-width touch-target" disabled>
                                    <span class="btn-icon">üìÑ</span>
                                    Cetak Struk
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Cart Section -->
                <section class="card cart-section">
                    <div class="card__header cart-header">
                        <h2>Keranjang Belanja</h2>
                        <button id="clearCartBtn" class="btn btn--outline btn--sm touch-target clear-btn">
                            <span class="btn-icon">üóëÔ∏è</span>
                            Kosongkan
                        </button>
                    </div>
                    <div class="card__body">
                        <div id="cartItems" class="cart-items">
                            <div class="empty-cart">
                                <div class="empty-cart-icon">üõí</div>
                                <p>Keranjang masih kosong</p>
                                <p class="empty-cart-subtitle">Tambahkan barang untuk mulai transaksi</p>
                            </div>
                        </div>
                        <div class="cart-summary">
                            <div class="cart-total">
                                <div class="total-row">
                                    <span class="total-label">Total Belanja</span>
                                    <span id="totalAmount" class="total-amount">Rp 0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <!-- Success Notification -->
    <div class="success-notification" id="successNotification" style="display:none;">
        <span id="successMessage">Item berhasil ditambahkan!</span>
    </div>

    <!-- Manage Items Modal -->
    <div class="modal" id="manageItemsModal" aria-hidden="true">
      <div class="modal-dialog">
        <header class="modal-header">
          <h3>Kelola Barang</h3>
          <button class="modal-close" id="closeManageBtn">‚úñ</button>
        </header>
        <div class="modal-body">
          <form id="manageItemForm">
            <div class="form-group">
              <label for="manageName">Nama Barang</label>
              <input id="manageName" class="form-control" autocomplete="off">
            </div>
            <div class="form-group">
              <label for="managePurchase">Harga Beli</label>
              <div class="currency-input-wrapper">
                <span class="currency-prefix">Rp</span>
                <input id="managePurchase" class="form-control currency-input" inputmode="numeric">
              </div>
            </div>
            <div class="form-group">
              <label for="manageSell">Harga Jual</label>
              <div class="currency-input-wrapper">
                <span class="currency-prefix">Rp</span>
                <input id="manageSell" class="form-control currency-input" inputmode="numeric">
              </div>
            </div>
            <input type="hidden" id="manageId">
            <div class="modal-actions">
              <button type="submit" id="saveManageBtn" class="btn btn--primary">Simpan</button>
              <button type="button" id="newManageBtn" class="btn btn--outline">Baru</button>
            </div>
          </form>

          <div class="items-list">
            <h4>Daftar Barang</h4>
            <table id="itemsTable" class="items-table">
              <thead>
                <tr><th>Nama</th><th>Beli</th><th>Jual</th><th>Aksi</th></tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- Earnings Modal -->
    <div class="modal" id="earningsModal" aria-hidden="true">
      <div class="modal-dialog">
        <header class="modal-header">
          <h3>Pendapatan</h3>
          <button class="modal-close" id="closeEarningsBtn">‚úñ</button>
        </header>
        <div class="modal-body">
          <div class="earnings-summary">
            <div class="earn-row">
              <span>Mingguan</span>
              <strong id="weeklyTotal">Rp 0</strong>
            </div>
            <div class="earn-row">
              <span>Bulanan</span>
              <strong id="monthlyTotal">Rp 0</strong>
            </div>
          </div>

          <div class="form-group">
            <label for="manualIncomeAmount">Catat Pemasukan Manual</label>
            <div class="currency-input-wrapper">
              <span class="currency-prefix">Rp</span>
              <input id="manualIncomeAmount" class="form-control currency-input" inputmode="numeric">
            </div>
            <div class="modal-actions">
              <button id="addIncomeBtn" class="btn btn--primary">Tambah Pemasukan</button>
            </div>
          </div>

          <div class="income-list">
            <h4>Riwayat Pemasukan</h4>
            <table id="incomeTable" class="items-table">
              <thead><tr><th>Tanggal</th><th>Jumlah</th><th>Sumber</th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
